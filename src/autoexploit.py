from utils import *
from payload_utils import *
from exploit_utils import *

def main():
        
    if len(sys.argv) < 2:
        logging.error("No target binary provided")
        sys.exit(1)

    args = check_args()
    target_bin = args.target

    context.log_level='warn'
    # context.log_level = 'debug'

    #the user must provide the crash input
    crash_input = generate_testcase(1500)



    reproducer(crash_input, args)

    while root_cause_analysis(crash_input, args) == False:
        logging.error("the payload did not reach the return address of the vulnerable of the stack frame in the target binary")
        sys.exit(1)
        crash_input = crash_explorer()

    payload_builder(crash_input, target_bin) 

    payload_tester(args)



if __name__ == "__main__":
    main()