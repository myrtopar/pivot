from utils import *
from payload_utils import *
from exploit_utils import *
from exploration_ulits import *

def main():
        
    if len(sys.argv) < 2:
        logging.error("No target binary provided")
        sys.exit(1)

    args = check_args()
    context.log_level='warn'
    # context.log_level = 'debug'

    crash_input = args.crash_input

    reproducer(crash_input, args)

    crash_mutation = crash_explorer2(crash_input, args)

    if(crash_mutation == None):
        logging.error("No successful crash input mutation found.")
        sys.exit(1)

    # while root_cause_analysis(crash_input, args) == False:
    #     logging.warning("Premature segmentation fault - control did not reach the overwritten return address.")
    #     crash_input = crash_explorer2(crash_input, args)

    payload_builder(crash_mutation, args.target) 

    payload_tester(args)



if __name__ == "__main__":
    main()